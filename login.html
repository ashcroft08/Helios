<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <script>
        (function () {
            const theme = localStorage.getItem('helios-theme') || 'light';
            document.documentElement.className = theme;
        })();
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Helios - Iniciar Sesión</title>
    <link rel="icon" type="image/svg+xml" href="img/favicon_helios.svg">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>

    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        primary: "#3b82f6",
                        "primary-hover": "#2563eb",
                        success: "#10b981",
                        warning: "#f59e0b",
                        danger: "#ef4444",
                        info: "#06b6d4",
                        "background-light": "#f8fafc",
                        "background-dark": "#0a0f1a",
                        "surface-dark": "#111827",
                        "card-dark": "#1e293b",
                        "sidebar-dark": "#0f172a",
                        accent: "#8b5cf6",
                    },
                    fontFamily: { display: ["Inter", "sans-serif"] },
                    borderRadius: { DEFAULT: "0.75rem" },
                },
            },
        };
    </script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        @keyframes mesh-pulse {
            0% {
                background-position: 0% 50%;
            }

            50% {
                background-position: 100% 50%;
            }

            100% {
                background-position: 0% 50%;
            }
        }

        @keyframes float {

            0%,
            100% {
                transform: translateY(0px);
            }

            50% {
                transform: translateY(-10px);
            }
        }

        @keyframes fade-in {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .bg-mesh {
            background: linear-gradient(-45deg, #f8fafc, #eff6ff, #f0fdf4, #f5f3ff);
            background-size: 400% 400%;
            animation: mesh-pulse 15s ease infinite;
        }

        .dark .bg-mesh {
            background: linear-gradient(-45deg, #0a0f1a, #0f172a, #1e1b4b, #0a0f1a);
            background-size: 400% 400%;
            animation: mesh-pulse 15s ease infinite;
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            animation: fade-in 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }

        .dark .glass-card {
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .input-glass {
            background: rgba(255, 255, 255, 0.5);
            border: 1px solid rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }

        .dark .input-glass {
            background: rgba(2, 6, 23, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .input-glass:focus {
            background: rgba(255, 255, 255, 0.9);
            border-color: #3b82f6;
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);
        }

        .dark .input-glass:focus {
            background: rgba(2, 6, 23, 0.8);
            border-color: #3b82f6;
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.2);
        }

        .theme-toggle-btn {
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            transition: all 0.3s ease;
        }

        .floating-logo {
            animation: float 4s ease-in-out infinite;
        }

        .btn-premium {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            box-shadow: 0 4px 15px rgba(37, 99, 235, 0.3);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .btn-premium:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(37, 99, 235, 0.4);
        }
    </style>
</head>

<body
    class="bg-background-light dark:bg-background-dark h-screen flex flex-col items-center justify-center p-4 bg-mesh relative overflow-hidden">

    <!-- Top Navigation / Theme Toggle -->
    <div class="absolute top-4 right-4 z-50">
        <button onclick="toggleLoginTheme()"
            class="theme-toggle-btn p-2.5 rounded-2xl bg-white/40 dark:bg-slate-800/40 border border-white/30 dark:border-slate-700/30 text-slate-700 dark:text-slate-300 hover:scale-110 active:scale-95 shadow-xl">
            <span class="material-icons-outlined block text-lg" id="login-theme-icon">dark_mode</span>
        </button>
    </div>

    <div class="w-full max-w-[400px] relative">
        <!-- Decoration Orbs -->
        <div class="absolute -top-10 -left-10 w-40 h-40 bg-primary/10 rounded-full blur-[60px] pointer-events-none">
        </div>
        <div class="absolute -bottom-10 -right-10 w-40 h-40 bg-accent/10 rounded-full blur-[60px] pointer-events-none">
        </div>

        <!-- Glass Card -->
        <div class="glass-card relative rounded-3xl p-7 shadow-2xl">

            <!-- Welcome Header -->
            <div class="text-center mb-6">
                <div class="floating-logo inline-block mb-4 relative">
                    <div class="absolute inset-0 bg-primary/20 blur-xl rounded-full scale-125"></div>
                    <img src="img/horizontal_helios.svg" alt="Helios" class="h-10 mx-auto dark:hidden relative z-10">
                    <img src="img/horizontal_helios_oscuro.png" alt="Helios"
                        class="h-10 mx-auto hidden dark:block relative z-10">
                </div>
                <h1 class="text-2xl font-extrabold text-slate-900 dark:text-white tracking-tight">Bienvenido/a</h1>
                <p class="text-slate-500 dark:text-slate-400 mt-1 text-xs font-medium">Gestiona tu equipo con Helios</p>
            </div>

            <!-- Error Message -->
            <div id="login-error" class="hidden mb-4 p-3 bg-danger/10 border border-danger/20 rounded-xl animate-shake">
                <div class="flex items-center gap-2">
                    <span class="material-icons-outlined text-danger text-lg">error_outline</span>
                    <p id="login-error-text" class="text-xs font-semibold text-danger"></p>
                </div>
            </div>

            <!-- Form -->
            <form id="login-form" class="space-y-4">
                <div>
                    <label
                        class="text-[10px] font-bold text-slate-400 dark:text-slate-500 uppercase tracking-[0.1em] mb-1.5 px-1 block">
                        Correo Corporativo
                    </label>
                    <div class="relative group">
                        <span
                            class="material-icons-outlined absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 text-lg group-focus-within:text-primary transition-colors">mail</span>
                        <input type="email" id="login-email" required autocomplete="email"
                            placeholder="usuario@provesa.com"
                            class="input-glass w-full rounded-xl pl-11 pr-4 py-3 text-sm text-slate-800 dark:text-slate-100 placeholder:text-slate-400 outline-none">
                    </div>
                </div>

                <div>
                    <label
                        class="text-[10px] font-bold text-slate-400 dark:text-slate-500 uppercase tracking-[0.1em] mb-1.5 px-1 block">
                        Contraseña
                    </label>
                    <div class="relative group">
                        <span
                            class="material-icons-outlined absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 text-lg group-focus-within:text-primary transition-colors">lock</span>
                        <input type="password" id="login-password" required autocomplete="current-password"
                            placeholder="••••••••"
                            class="input-glass w-full rounded-xl pl-11 pr-11 py-3 text-sm text-slate-800 dark:text-slate-100 placeholder:text-slate-400 outline-none">
                        <button type="button" onclick="togglePassword()"
                            class="absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 hover:text-primary transition-colors">
                            <span class="material-icons-outlined text-lg"
                                id="password-toggle-icon">visibility_off</span>
                        </button>
                    </div>
                </div>

                <div class="pt-1">
                    <button type="submit" id="btn-login"
                        class="btn-premium w-full text-white py-3.5 rounded-xl font-bold text-sm flex items-center justify-center gap-2">
                        <span id="btn-login-icon" class="material-icons-outlined text-lg">login</span>
                        <span id="btn-login-text">Entrar al Sistema</span>
                    </button>
                </div>
            </form>

            <!-- Footer Badge -->
            <div class="mt-7 text-center relative">
                <div
                    class="absolute inset-x-0 top-1/2 -translate-y-1/2 border-t border-slate-200 dark:border-slate-800">
                </div>
                <span
                    class="relative z-10 bg-white dark:bg-slate-900 px-3 py-0.5 rounded-full text-[9px] font-black text-slate-400 dark:text-slate-600 tracking-[0.2em] uppercase">
                    PROVESA S.C.C
                </span>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/firebase-config.js"></script>
    <script src="js/auth.js"></script>
    <script>
        firebase.auth().onAuthStateChanged((user) => {
            if (user) window.location.href = 'index.html';
        });

        document.getElementById('login-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('login-email').value.trim();
            const password = document.getElementById('login-password').value;
            const btn = document.getElementById('btn-login');
            const errorDiv = document.getElementById('login-error');
            const errorText = document.getElementById('login-error-text');

            errorDiv.classList.add('hidden');
            btn.disabled = true;
            document.getElementById('btn-login-icon').textContent = 'sync';
            document.getElementById('btn-login-icon').classList.add('animate-spin');
            document.getElementById('btn-login-text').textContent = 'Validando acceso...';

            const result = await loginUser(email, password);

            if (result.success) {
                document.getElementById('btn-login-text').textContent = '¡Acceso Concedido!';
                document.getElementById('btn-login-icon').textContent = 'verified_user';
                document.getElementById('btn-login-icon').classList.remove('animate-spin');
                setTimeout(() => window.location.href = 'index.html', 500);
            } else {
                errorText.textContent = result.message;
                errorDiv.classList.remove('hidden');
                btn.disabled = false;
                document.getElementById('btn-login-icon').textContent = 'login';
                document.getElementById('btn-login-icon').classList.remove('animate-spin');
                document.getElementById('btn-login-text').textContent = 'Entrar al Sistema';
            }
        });

        function togglePassword() {
            const input = document.getElementById('login-password');
            const icon = document.getElementById('password-toggle-icon');
            if (input.type === 'password') {
                input.type = 'text';
                icon.textContent = 'visibility';
            } else {
                input.type = 'password';
                icon.textContent = 'visibility_off';
            }
        }

        function toggleLoginTheme() {
            const currentTheme = document.documentElement.classList.contains('dark') ? 'dark' : 'light';
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            document.documentElement.className = newTheme;
            localStorage.setItem('helios-theme', newTheme);
            document.getElementById('login-theme-icon').textContent = newTheme === 'dark' ? 'light_mode' : 'dark_mode';
        }

        (function () {
            const theme = document.documentElement.classList.contains('dark') ? 'dark' : 'light';
            document.getElementById('login-theme-icon').textContent = theme === 'dark' ? 'light_mode' : 'dark_mode';
        })();
    </script>
</body>

</html>